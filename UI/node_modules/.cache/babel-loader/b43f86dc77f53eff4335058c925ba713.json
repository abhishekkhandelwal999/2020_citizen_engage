{"ast":null,"code":"import _classCallCheck from\"/Users/khandelwal_abhishek/gnits/2020_citizen_engage-master/UI/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/khandelwal_abhishek/gnits/2020_citizen_engage-master/UI/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/khandelwal_abhishek/gnits/2020_citizen_engage-master/UI/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/khandelwal_abhishek/gnits/2020_citizen_engage-master/UI/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/khandelwal_abhishek/gnits/2020_citizen_engage-master/UI/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/khandelwal_abhishek/gnits/2020_citizen_engage-master/UI/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";//import img from '../images/complaint.jpg';\nimport Nav from'./nav.js';// const image = {\n//     backgroundImage: 'url(' + img + ')',\n//     width: \"100%\",\n//     height: '100%',\n//     backgroundRepeat: 'no-repeat',\n//     backgroundSize: '100% 100%',\n//   }\nvar body;var complaint=/*#__PURE__*/function(_Component){_inherits(complaint,_Component);function complaint(props){var _this;_classCallCheck(this,complaint);_this=_possibleConstructorReturn(this,_getPrototypeOf(complaint).call(this,props));_this.handleImageChange=function(event){_this.setState({image:event.target.value});console.log(_this.state.image);};_this.handleDescriptionChange=function(event){_this.setState({description:event.target.value});};_this.handleImageChange=_this.handleImageChange.bind(_assertThisInitialized(_this));_this.handleDescriptionChange=_this.handleDescriptionChange.bind(_assertThisInitialized(_this));_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));//this.validateForm = this.validateForm.bind(this);\n//\n_this.state={image:\"\",description:\"\"//confirmPassword: \"\"\n};return _this;}_createClass(complaint,[{key:\"CurDateTime\",value:function CurDateTime(){var tempDate=new Date();var date=tempDate.getFullYear()+'-'+(tempDate.getMonth()+1)+'-'+tempDate.getDate()+' '+tempDate.getHours()+':'+tempDate.getMinutes()+':'+tempDate.getSeconds();var currDate=\"Current Date= \"+date;console.log(currDate);return(// <p>{currDate}</p>\ndate);}},{key:\"handleSubmit\",value:function handleSubmit(event){var _this2=this;console.log(\"sample\"+this.state.image);event.preventDefault();var totalimgname=this.state.image.split(\"\\\\\");var imgname=totalimgname[totalimgname.length-1];body={Cid:sessionStorage.getItem(\"Cid\"),ClosedImage:imgname,ClosedDescription:this.state.description,ClosedAt:this.CurDateTime(),Status:\"Closed\"};console.log(body);if(this.state.image===\"\"){alert('Please select the image');}else if(this.state.description===\"\"){alert('Please enter the description');}else{var url=\"http://localhost:9000/viewandclose\";var headers=new Headers();headers.append('Content-Type','application/json');headers.append('Accept','application/json');headers.append('Access-Control-Allow-origin',url);headers.append('Access-Control-Allow-Credentials','true');headers.append('GET','POST');fetch(url,{headers:headers,method:'POST',body:JSON.stringify(body)}).then(function(response){if(response.ok){console.log(response);var EMAIL=sessionStorage.getItem(\"UserMail\");var NAME=sessionStorage.getItem(\"MailName\");var templateId='template_NgHqYVXi';var EMAILMESSAGE=\"The \"+sessionStorage.getItem(\"MailCategory\")+\" complaint you filed in \"+sessionStorage.getItem(\"MailLocation\")+\" is successfully solved.\";_this2.sendFeedback(templateId,{message_html:EMAILMESSAGE,from_name:\"CITIZENS ENGAGE ADMIN\",email:EMAIL,to_name:NAME});alert(\"Closed successfully\");_this2.props.history.push(\"/adminhome\");}else if(!response.ok){console.log(response);alert(\"Complaint cannot be closed\");}})// .then(response =>{window.location.href=\"/Login\"});             \n.catch(function(){return console.log(\"can't access\"+url+\"response. \");});}}},{key:\"sendFeedback\",value:function sendFeedback(templateId,variables){window.emailjs.send('gmail',templateId,variables).then(function(res){console.log('Email successfully sent!');})// Handle errors here however you like, or use a React error boundary\n.catch(function(err){return console.error('Oh well, you failed. Here some thoughts on the error that occured:',err);});}},{key:\"render\",value:function render(){// var eid=this.props.match.params.id;\n// console.log(eid);\n// var identity = sessionStorage.getItem(\"Identity\");\n// var emailid = sessionStorage.getItem(\"EmailId\");\n// console.log(\"session storage:\"+identity+\" : \"+emailid);\nreturn React.createElement(\"div\",{class:\"wrapper\"},React.createElement(Nav,null),React.createElement(\"div\",{class:\"main_content\"},React.createElement(\"center\",null,React.createElement(\"div\",{class:\"header\"},React.createElement(\"b\",null,\"Closing Complaint\")),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"div\",{class:\"info\"},React.createElement(\"div\",{className:\"auth-wrapper\"},React.createElement(\"div\",{className:\"auth-inner\"},React.createElement(\"div\",null,React.createElement(\"form\",null,React.createElement(\"div\",{className:\"form-group\"},\"Upload Image:\",React.createElement(\"input\",{type:\"file\",name:\"image\",value:this.state.image,onChange:this.handleImageChange})),React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",null,\"Description:\"),React.createElement(\"br\",null),React.createElement(\"textarea\",{cols:33,rows:4,name:\"description\",onChange:this.handleDescriptionChange,value:this.state.description})),React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary btn-block\",onClick:this.handleSubmit},\"Submit\")))))))));}}]);return complaint;}(Component);export{complaint as default};","map":{"version":3,"sources":["/Users/khandelwal_abhishek/gnits/2020_citizen_engage-master/UI/src/components/admin/viewAndClose.js"],"names":["React","Component","Nav","body","complaint","props","handleImageChange","event","setState","image","target","value","console","log","state","handleDescriptionChange","description","bind","handleSubmit","tempDate","Date","date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","currDate","preventDefault","totalimgname","split","imgname","length","Cid","sessionStorage","getItem","ClosedImage","ClosedDescription","ClosedAt","CurDateTime","Status","alert","url","headers","Headers","append","fetch","method","JSON","stringify","then","response","ok","EMAIL","NAME","templateId","EMAILMESSAGE","sendFeedback","message_html","from_name","email","to_name","history","push","catch","variables","window","emailjs","send","res","err","error"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\n//import img from '../images/complaint.jpg';\nimport Nav from './nav.js';\n\n\n\n// const image = {\n//     backgroundImage: 'url(' + img + ')',\n//     width: \"100%\",\n//     height: '100%',\n//     backgroundRepeat: 'no-repeat',\n//     backgroundSize: '100% 100%',\n//   }\n  var body;\n  \nexport default class complaint extends Component {\n    constructor(props) {\n        super(props);     \n        this.handleImageChange = this.handleImageChange.bind(this);\n        this.handleDescriptionChange=this.handleDescriptionChange.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n        //this.validateForm = this.validateForm.bind(this);\n    \n        //\n      \n        this.state = {\n          image:\"\",\n          description:\"\",\n         \n          //confirmPassword: \"\"\n          \n        };\n    \n      }\n     CurDateTime() {\n        var tempDate = new Date();\n       var date = tempDate.getFullYear() + '-' + (tempDate.getMonth()+1) + '-' + tempDate.getDate() +' '+ tempDate.getHours()+':'+ tempDate.getMinutes()+':'+ tempDate.getSeconds();\n        const currDate = \"Current Date= \"+date;\n        console.log(currDate);\n        return (\n          // <p>{currDate}</p>\n          date\n        );\n      }\n      \n    \n      handleImageChange = event => {\n        this.setState({\n          image : event.target.value\n        });\n        console.log(this.state.image);\n      }\n    \n      handleDescriptionChange = event => {\n        this.setState({\n          description : event.target.value\n        });\n      }\n    \n    \n    \n      handleSubmit(event) {\n        console.log(\"sample\"+this.state.image);\n        event.preventDefault();\n        var totalimgname = this.state.image.split(\"\\\\\");\n        var imgname = totalimgname[totalimgname.length-1];\n        body = {\n          Cid: sessionStorage.getItem(\"Cid\"),\n          ClosedImage: imgname,\n          ClosedDescription: this.state.description,\n          ClosedAt : this.CurDateTime(),\n          Status : \"Closed\",\n        }\n        console.log(body);\n        if (this.state.image === \"\"){\n          alert('Please select the image')\n        }\n        \n        else if(this.state.description === \"\"){\n          alert('Please enter the description')\n        }\n        else{\n           const url = \"http://localhost:9000/viewandclose\";\n           let headers = new Headers();\n     \n           headers.append('Content-Type','application/json');\n           headers.append('Accept','application/json');\n     \n           headers.append('Access-Control-Allow-origin',url);\n           headers.append('Access-Control-Allow-Credentials','true');\n     \n           headers.append('GET','POST');\n     \n           fetch(url, {\n            headers:headers,\n            method: 'POST',\n            body: JSON.stringify(body)\n         })\n         .then(response => {if(response.ok){\n            console.log(response);\n            const EMAIL = sessionStorage.getItem(\"UserMail\");\n            const NAME = sessionStorage.getItem(\"MailName\");\n            const templateId = 'template_NgHqYVXi';\n            const EMAILMESSAGE= \"The \"+sessionStorage.getItem(\"MailCategory\")+\" complaint you filed in \"+sessionStorage.getItem(\"MailLocation\")+\" is successfully solved.\"\n            this.sendFeedback(templateId, {message_html: EMAILMESSAGE, from_name: \"CITIZENS ENGAGE ADMIN\", email: EMAIL, to_name: NAME})\n            alert(\"Closed successfully\");\n            this.props.history.push(\"/adminhome\");\n          }\n          \n          else if(!response.ok){\n            console.log(response);\n            alert(\"Complaint cannot be closed\");\n          }\n          })\n          // .then(response =>{window.location.href=\"/Login\"});             \n       \n     .catch(()=> console.log(\"can't access\" + url + \"response. \"))\n        }\n    \n      \n      }\n\n      sendFeedback (templateId, variables) {\n        window.emailjs.send(\n          'gmail', templateId,\n          variables\n          ).then(res => {\n            console.log('Email successfully sent!')\n          })\n          // Handle errors here however you like, or use a React error boundary\n          .catch(err => console.error('Oh well, you failed. Here some thoughts on the error that occured:', err))\n        }\n    \n    render() {\n      // var eid=this.props.match.params.id;\n      // console.log(eid);\n      // var identity = sessionStorage.getItem(\"Identity\");\n      // var emailid = sessionStorage.getItem(\"EmailId\");\n      // console.log(\"session storage:\"+identity+\" : \"+emailid);\n      \n        return (\n            <div class=\"wrapper\">\n               <Nav/>      \n                <div class=\"main_content\">\n                    <center>\n                    <div class=\"header\"><b>Closing Complaint</b></div>  \n                    <br/><br/>\n                    <div class=\"info\">\n                    <div className=\"auth-wrapper\">\n    <div className=\"auth-inner\">\n    <div>\n            <form>\n\n                <div className=\"form-group\">\n                    Upload Image:\n                    <input type=\"file\" name=\"image\" value = {this.state.image} onChange={this.handleImageChange} />\n                </div>\n                <div className=\"form-group\">\n                    <label>Description:</label><br></br>\n                    <textarea cols={33} rows={4} name=\"description\" onChange={this.handleDescriptionChange} value={this.state.description}/>\n                </div>\n                <button type=\"submit\" className=\"btn btn-primary btn-block\" onClick={this.handleSubmit}>Submit</button>        \n            </form>\n        </div>\n        </div>\n            </div>\n                    </div>\n                    </center>\n                     \n                    \n                    </div>\n            \n          </div>  \n            \n        );\n    }\n}"]},"metadata":{},"sourceType":"module"}