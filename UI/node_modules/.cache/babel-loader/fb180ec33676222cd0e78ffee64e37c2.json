{"ast":null,"code":"var _jsxFileName = \"/Users/khandelwal_abhishek/gnits/2020_citizen_engage/UI/src/components/admin/viewComplaints.js\";\nimport React, { Component } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport './view.css';\nimport './adminhome.css';\nimport Nav from './nav.js';\nimport { BootstrapTable, TableHeaderColumn } from 'react-bootstrap-table'; // import img from '../images/userlogin.jpeg';\n// import UserProfile from '../User/UserProfile';\n// import {createBrowserHistory} from 'history';\n\nimport { Container, Row, Col } from 'react-bootstrap';\nvar body;\nvar print;\n\nfunction sendAlert(row) {\n  var EMAIL;\n\n  if (row.Category == \"Electricity\") {\n    EMAIL = \"meghana.honey44@gmail.com\";\n  } else if (row.Category == \"Road\") {\n    EMAIL = \"himajareddy2016@gmail.com\";\n  } else if (row.Category == \"Water\") {\n    EMAIL = \"pavanisiddam2k@gmail.com\";\n  } else if (row.Category == \"Garbage\") {\n    EMAIL = \"sarikamanchala.999@gmail.com\";\n  }\n\n  const templateId = 'template_NgHqYVXi';\n  const EMAILMESSAGE = \"The Complaint with Id:\" + row.Cid + \" is delayed more than fixed period.Take immediate action else serious action will be taken against you.\";\n  sendFeedback(templateId, {\n    message_html: EMAILMESSAGE,\n    from_name: \"CITIZENS ENGAGE ADMIN\",\n    email: EMAIL\n  });\n  alert(\"Alert Send successfully\");\n}\n\nfunction sendFeedback(templateId, variables) {\n  window.emailjs.send('gmail', templateId, variables).then(res => {\n    console.log('Email successfully sent!');\n  }) // Handle errors here however you like, or use a React error boundary\n  .catch(err => console.error('Oh well, you failed. Here some thoughts on the error that occured:', err));\n}\n\nconst Status = {\n  'Pending': 'Pending',\n  'Closed': 'Closed'\n};\nconst Category = {\n  'Electricity': 'Electricity',\n  'Water': 'Water',\n  'Road': 'Road',\n  'Garbage': 'Garbage'\n};\n\nfunction enumFormatter(cell, row, enumObject) {\n  //window.location.reload(false);\n  return enumObject[cell];\n}\n\nclass viewComplaints extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      complaints: []\n    };\n  }\n\n  indexN(cell, row, enumObject, index) {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }, index + 1);\n  }\n\n  componentDidMount() {\n    const url = \"http://localhost:9000/getComplaints\";\n    let headers = new Headers();\n    headers.append('Content-Type', 'application/json');\n    headers.append('Accept', 'application/json');\n    headers.append('Access-Control-Allow-origin', url);\n    headers.append('Access-Control-Allow-Credentials', 'true');\n    headers.append('POST', 'GET');\n    fetch(url, {\n      headers: headers,\n      method: 'GET',\n      body: JSON.stringify(body)\n    }).then(response => {\n      if (response.ok) {\n        // UserProfile.setEmail(this.state.email);\n        response.json().then(res => {\n          console.log(res);\n          this.setState({\n            complaints: res\n          });\n        });\n      } else if (!response.ok) {\n        console.log(\"Wrong email or password\");\n        alert(\"No data\");\n      }\n    });\n  }\n\n  expandComponent(row) {\n    var createdimg = \"/images/\" + row.CreatedImage;\n    var closedtime;\n    var closedimg;\n    var image;\n    var flag = 1; // var creat=row.CreatedAt;\n    // var diff=creat-CurDateTime()\n\n    var createdtime = row.CreatedAt;\n    var pdate = new Date();\n    var presenthours = pdate.getHours();\n    var presentMonth = pdate.getMonth() + 1;\n    var presentYear = pdate.getFullYear();\n    var presentDate = pdate.getDate();\n    var total = createdtime.split(\" \", 2);\n    var date = total[0].split(\"-\", 3);\n    var years = date[0];\n    var months = date[1];\n    var day = date[2];\n    var time = total[1].split(\":\", 3);\n    var hour = time[0];\n    var diffm = presentMonth - months;\n    var diffd = presentDate - day;\n    var diffh = presenthours - hour;\n    var diff = presenthours - hour;\n    console.log(\"diffmonth\", diffm);\n    console.log(\"diffhours\", diffh);\n    console.log(\"diffday\", diffd);\n\n    if (row.Category === 'Road') {\n      if (diffm > 1) {\n        flag = 0;\n        print = diffm + \" Months\";\n      } else if (diffd > 4) {\n        flag = 0;\n        print = diffd + \" Days\";\n      } else {\n        flag = 1;\n        print = diffh + \" Hours\";\n      }\n    } else if (row.Category === 'Electricity') {\n      if (diffm > 1) {\n        flag = 0;\n        print = diffm + \" Months\";\n      } else if (diffd >= 2) {\n        flag = 0;\n        print = diffd + \" Days\";\n      } else if (diffh > 3) {\n        flag = 0;\n        print = diffh + \" Hours\";\n      } else {\n        flag = 1;\n        print = diffh + \" Hours\";\n      }\n    } else if (row.Category === 'Garbage') {\n      if (diffm > 1) {\n        flag = 0;\n        print = diffm + \" Months\";\n      } else if (diffd > 2) {\n        flag = 0;\n        print = diffd + \" Days\";\n      } else {\n        flag = 1;\n        print = diffh + \" Hours\";\n      }\n    } else if (row.Category === 'Water') {\n      if (diffm > 1) {\n        flag = 0;\n        print = diffm + \" Months\";\n      } else if (diffd > 1) {\n        flag = 0;\n        print = diffd + \" Days\";\n      } else {\n        flag = 1;\n        print = diffh + \" Hours\";\n      }\n    }\n\n    if (row.Status === \"Pending\") {\n      closedimg = row.ClosedImage;\n      closedtime = \"Not Yet Closed\";\n\n      if (flag === 0) {\n        image = React.createElement(Row, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }, React.createElement(Col, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198\n          },\n          __self: this\n        }, \"It is Delayed by :\", print), React.createElement(Col, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          className: \"btn btn-danger btn-block\",\n          onClick: event => {\n            sendAlert(row);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199\n          },\n          __self: this\n        }, \"Send an Alert\")));\n      } //        image = <Row>\n      //         <Col>\n      //         <button type=\"submit\" className=\"btn btn-primary btn-block\" onClick={(event) => \n      //           {sessionStorage.setItem(\"Cid\",row.Cid)\n      //           sessionStorage.setItem(\"UserMail\",row.Email)\n      //           sessionStorage.setItem(\"MailLocation\",row.Location)\n      //           sessionStorage.setItem(\"MailCategory\",row.Category)\n      //           sessionStorage.setItem(\"MailName\",row.Name)\n      //           window.location.href= \"/viewandclose\"}}>Take Action</button></Col>\n      // </Row>\n\n    } else {\n      var img = \"/images/\" + row.ClosedImage;\n      closedimg = React.createElement(\"img\", {\n        src: img,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      });\n      closedtime = row.ClosedAt;\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, React.createElement(Container, {\n      border: \"5px\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }, React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, React.createElement(Col, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, \"Created Time : \", row.CreatedAt), React.createElement(Col, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, \"Closed Time : \", closedtime)), React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }, React.createElement(Col, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }, \"Problem Image : \", React.createElement(\"img\", {\n      src: createdimg,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    })), React.createElement(Col, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231\n      },\n      __self: this\n    }, \"Solved Image :\", closedimg)), React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233\n      },\n      __self: this\n    }, React.createElement(Col, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }, \"Problem Description:\", row.CreatedDescription), React.createElement(Col, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235\n      },\n      __self: this\n    }, \"Solution Description:\", row.ClosedDescription)), image));\n  }\n\n  isExpandableRow(row) {\n    return true;\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251\n      },\n      __self: this\n    }, React.createElement(Nav, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"main_content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }, React.createElement(\"u\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }, \"Complaints\"))), React.createElement(BootstrapTable, {\n      data: this.state.complaints,\n      expandComponent: this.expandComponent,\n      expandableRow: this.isExpandableRow,\n      striped: true,\n      hover: true,\n      condensed: true,\n      pagination: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, React.createElement(TableHeaderColumn, {\n      width: \"70\",\n      dataField: \"any\",\n      dataFormat: this.indexN,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    }, \"S.No\"), React.createElement(TableHeaderColumn, {\n      width: \"150\",\n      dataField: \"Cid\",\n      isKey: true,\n      hidden: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, \"CID\"), React.createElement(TableHeaderColumn, {\n      width: \"150\",\n      dataField: \"Email\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }, \"EMAIL\"), React.createElement(TableHeaderColumn, {\n      width: \"150\",\n      dataField: \"Category\",\n      filterFormatted: true,\n      dataFormat: enumFormatter,\n      formatExtraData: Category,\n      filter: {\n        type: 'SelectFilter',\n        options: Category\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261\n      },\n      __self: this\n    }, \"CATEGORY\"), React.createElement(TableHeaderColumn, {\n      width: \"150\",\n      dataField: \"Location\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262\n      },\n      __self: this\n    }, \"LOCATION\"), React.createElement(TableHeaderColumn, {\n      width: \"150\",\n      dataField: \"Status\",\n      filterFormatted: true,\n      dataFormat: enumFormatter,\n      formatExtraData: Status,\n      filter: {\n        type: 'SelectFilter',\n        options: Status\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263\n      },\n      __self: this\n    }, \"STATUS\")))));\n  }\n\n}\n\nexport default withRouter(viewComplaints);","map":{"version":3,"sources":["/Users/khandelwal_abhishek/gnits/2020_citizen_engage/UI/src/components/admin/viewComplaints.js"],"names":["React","Component","withRouter","Nav","BootstrapTable","TableHeaderColumn","Container","Row","Col","body","print","sendAlert","row","EMAIL","Category","templateId","EMAILMESSAGE","Cid","sendFeedback","message_html","from_name","email","alert","variables","window","emailjs","send","then","res","console","log","catch","err","error","Status","enumFormatter","cell","enumObject","viewComplaints","constructor","props","state","complaints","indexN","index","componentDidMount","url","headers","Headers","append","fetch","method","JSON","stringify","response","ok","json","setState","expandComponent","createdimg","CreatedImage","closedtime","closedimg","image","flag","createdtime","CreatedAt","pdate","Date","presenthours","getHours","presentMonth","getMonth","presentYear","getFullYear","presentDate","getDate","total","split","date","years","months","day","time","hour","diffm","diffd","diffh","diff","ClosedImage","event","img","ClosedAt","CreatedDescription","ClosedDescription","isExpandableRow","render","type","options"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport {  withRouter} from \"react-router-dom\";\nimport './view.css';\nimport './adminhome.css'\nimport Nav  from './nav.js';\nimport {BootstrapTable, TableHeaderColumn} from 'react-bootstrap-table';\n// import img from '../images/userlogin.jpeg';\n// import UserProfile from '../User/UserProfile';\n// import {createBrowserHistory} from 'history';\nimport {Container,Row,Col} from 'react-bootstrap';\n\nvar body;\nvar print;\nfunction sendAlert(row)\n{  var EMAIL;\n  if(row.Category==\"Electricity\")\n  {\n     EMAIL = \"meghana.honey44@gmail.com\"\n  }\n  else if(row.Category==\"Road\")\n  {\n   EMAIL=\"himajareddy2016@gmail.com\"\n  }\n  else if(row.Category==\"Water\")\n   {\n     EMAIL=\"pavanisiddam2k@gmail.com\"\n   }\n   else if(row.Category==\"Garbage\")\n   {\n     EMAIL=\"sarikamanchala.999@gmail.com\"\n   }\n    const templateId = 'template_NgHqYVXi';\n    const EMAILMESSAGE= \"The Complaint with Id:\"+row.Cid+\" is delayed more than fixed period.Take immediate action else serious action will be taken against you.\"\n    sendFeedback(templateId, {message_html: EMAILMESSAGE, from_name: \"CITIZENS ENGAGE ADMIN\", email: EMAIL})\n    alert(\"Alert Send successfully\");\n    }\n\nfunction sendFeedback (templateId, variables) {\n  window.emailjs.send(\n    'gmail', templateId,\n    variables\n    ).then(res => {\n      console.log('Email successfully sent!')\n    })\n    // Handle errors here however you like, or use a React error boundary\n    .catch(err => console.error('Oh well, you failed. Here some thoughts on the error that occured:', err))\n  } \n\nconst Status = {\n  'Pending': 'Pending',\n  'Closed': 'Closed',\n  };\nconst Category = {\n  'Electricity':'Electricity',\n  'Water':'Water',\n  'Road':'Road',\n  'Garbage':'Garbage',\n}\n  function enumFormatter(cell, row, enumObject) {\n    //window.location.reload(false);\n  return enumObject[cell];\n  }\n\nclass viewComplaints extends Component{\n  constructor(props) {\n    super(props);\n    this.state={\n      complaints :[]\n    }\n    \n  }\n  indexN(cell, row, enumObject, index) {\n    return (<div>{index+1}</div>) \n}\n\n  componentDidMount() {\n   \n        const url = \"http://localhost:9000/getComplaints\";\n          let headers = new Headers();\n      \n          headers.append('Content-Type','application/json');\n          headers.append('Accept','application/json');\n      \n          headers.append('Access-Control-Allow-origin',url);\n          headers.append('Access-Control-Allow-Credentials','true');\n      \n          headers.append('POST','GET');\n      \n          fetch(url, {\n            headers:headers,\n            method: 'GET',\n            body: JSON.stringify(body)\n          })\n          .then(response => {if(response.ok){\n            // UserProfile.setEmail(this.state.email);\n            response.json()\n            .then(res=> {\n              console.log(res)\n              this.setState({\n                  complaints : res\n              })          \n            })\n          }\n          else if(!response.ok){\n            console.log(\"Wrong email or password\")\n            alert(\"No data\")\n          }\n          })\n   \n    } \n\n   \n\n    expandComponent(row) {\n      var createdimg=\"/images/\"+row.CreatedImage;\n      var closedtime;\n      var closedimg;\n      var image;\n      var flag=1;\n    // var creat=row.CreatedAt;\n    // var diff=creat-CurDateTime()\n    var createdtime = row.CreatedAt;\n    var pdate = new Date();\n    var presenthours = pdate.getHours();\n    var presentMonth=pdate.getMonth()+1;\n    var presentYear=pdate.getFullYear();\n    var presentDate=pdate.getDate();\n    var total = createdtime.split(\" \",2);\n    var date = total[0].split(\"-\",3);\n    var years = date[0];\n    var months = date[1];\n    var day =  date[2];\n    var time = total[1].split(\":\",3)\n    var hour = time[0];\n    var diffm=presentMonth-months;\n    var diffd=presentDate-day;\n    var diffh=presenthours-hour;\n    \n    var diff = presenthours-hour;\n    console.log(\"diffmonth\",diffm);\n    console.log(\"diffhours\",diffh);\n    console.log(\"diffday\",diffd);\n    if(row.Category==='Road')\n    {\n      if(diffm>1)\n      {\n        flag=0;\n        print=diffm+\" Months\";\n      }\n      else if(diffd>4){ flag=0; print=diffd+\" Days\"}\n     \n      else {\n      flag=1; print=diffh+\" Hours\"}\n    }\n    else if(row.Category==='Electricity')\n    {\n      if(diffm>1)\n      {\n        flag=0;\n        print=diffm+\" Months\";\n      }\n    else if(diffd>=2){\n      flag=0;print=diffd+\" Days\"}\n      else if(diffh>3){\n      flag=0;print=diffh+\" Hours\"}\n      else{\n      flag=1;print=diffh+\" Hours\"}\n    }\n    else if(row.Category==='Garbage')\n    {\n      if(diffm>1)\n      {\n        flag=0;\n        print=diffm+\" Months\";\n      }\n      else if(diffd>2){ flag=0; print=diffd+\" Days\"}\n     \n      else {\n      flag=1; print=diffh+\" Hours\"}\n    }\n    else if(row.Category==='Water')\n    {\n      if(diffm>1)\n      {\n        flag=0;\n        print=diffm+\" Months\";\n      }\n      else if(diffd>1){ flag=0; print=diffd+\" Days\"}\n     \n      else {\n      flag=1; print=diffh+\" Hours\"}\n    }\n      if(row.Status === \"Pending\"){\n        closedimg = row.ClosedImage;\n        closedtime = \"Not Yet Closed\";\n        if(flag===0){\n          image= <Row>\n            <Col>It is Delayed by :{print}</Col>\n            <Col><button className=\"btn btn-danger btn-block\" onClick={event =>  \n             {\n               sendAlert(row);\n            }}>Send an Alert</button></Col>\n            \n      </Row>}\n//        image = <Row>\n//         <Col>\n//         <button type=\"submit\" className=\"btn btn-primary btn-block\" onClick={(event) => \n//           {sessionStorage.setItem(\"Cid\",row.Cid)\n//           sessionStorage.setItem(\"UserMail\",row.Email)\n//           sessionStorage.setItem(\"MailLocation\",row.Location)\n//           sessionStorage.setItem(\"MailCategory\",row.Category)\n//           sessionStorage.setItem(\"MailName\",row.Name)\n//           window.location.href= \"/viewandclose\"}}>Take Action</button></Col>\n// </Row>\n      }\n      else{\n        var img = \"/images/\"+row.ClosedImage;\n        closedimg=<img src={img}/>;\n        closedtime = row.ClosedAt;\n      }\n      return (\n        <div>\n          <Container border=\"5px\">\n            <Row>\n              {/* <Col>Cid : {row.Cid}</Col> */}\n              <Col>Created Time : {row.CreatedAt}</Col>\n              <Col>Closed Time : {closedtime}</Col>\n            </Row>\n           <Row>\n              <Col>Problem Image : <img src={createdimg}/></Col>\n      <Col>Solved Image :{closedimg}</Col>\n          </Row>\n          <Row>\n      <Col>Problem Description:{row.CreatedDescription}</Col>\n      <Col>Solution Description:{row.ClosedDescription}</Col>\n      </Row>{image}\n</Container>\n        </div>\n      );\n    }\n\n    isExpandableRow(row) {    \n        return true;      \n    }\n    \n\n    render() {\n       \n        return (\n        <div>\n            <div className=\"wrapper\">\n            <Nav/>\n            <br></br><br/>\n            <br/>\n                    <div className=\"main_content\">\n                        <div className=\"header\"><h2><u>Complaints</u></h2></div>\n          <BootstrapTable data={ this.state.complaints } expandComponent={ this.expandComponent } expandableRow={ this.isExpandableRow } striped hover condensed pagination>\n          <TableHeaderColumn width='70' dataField=\"any\" dataFormat={this.indexN}>S.No</TableHeaderColumn>\n          <TableHeaderColumn width='150' dataField='Cid' isKey hidden>CID</TableHeaderColumn>\n          <TableHeaderColumn  width='150' dataField='Email'>EMAIL</TableHeaderColumn>\n          <TableHeaderColumn width='150' dataField='Category' filterFormatted dataFormat={ enumFormatter }  formatExtraData={ Category } filter={ { type: 'SelectFilter', options: Category }}>CATEGORY</TableHeaderColumn>\n          <TableHeaderColumn width='150' dataField='Location'>LOCATION</TableHeaderColumn>\n          <TableHeaderColumn width='150' dataField='Status' filterFormatted dataFormat={ enumFormatter }  formatExtraData={ Status } filter={ { type: 'SelectFilter', options: Status } }>STATUS</TableHeaderColumn>\n           \n      </BootstrapTable>\n            \n          </div></div></div>\n        );\n    }\n}\nexport default withRouter(viewComplaints);"]},"metadata":{},"sourceType":"module"}